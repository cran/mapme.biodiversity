<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Quickstart</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quickstart</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In the following we will demonstrate an idealized workflow based on a
subset of the Global Forest Watch (GFW) data set that is delivered
together with this package. You can follow along the code snippets below
to reproduce the results. Please note that to reduce the time it takes
to process this vignette, we will not download any resources from the
internet. In a real use case, thus processing time might substantially
increase because resources have to be downloaded and real portfolios
might be larger than the one created in this example.</p>
<p>This vignette assumes that you have already followed the steps in <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/installation.html">Installation</a>
and have familiarized yourself with the terminology used in the package.
If you are unfamiliar with the terminology used here, please head over
to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/terminology.html">Terminology</a>
article to learn about the most important concepts.</p>
<p>The idealized workflow for using <code>{mapme.biodiversity}</code>
consists of the following steps:</p>
<ul>
<li>prepare your sf-object containing only geometries of type
<code>&#39;POLYGON&#39;</code> or <code>&#39;MULTIPOLYGON&#39;</code></li>
<li>decide which indicator(s) you wish to calculate and make the
required resource(s) available</li>
<li>conduct your indicator calculation, which adds a nested list column
to your portfolio object</li>
<li>continue your analysis in R or decide to export your results to a
spatial data format to use it with other geospatial software</li>
</ul>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>First, we will load the <code>{mapme.biodiversity}</code> and the
<code>{sf}</code> package for handling spatial vector data. For tabular
data handling, we will also load the <code>{dplyr}</code> and
<code>{tidyr}</code> packages. Then, we will read an internal GeoPackage
which includes part of the geometry of a protected area in the Dominican
Republic from the WDPA database.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mapme.biodiversity)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>aoi_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;gfw_sample.gpkg&quot;</span>, <span class="at">package =</span> <span class="st">&quot;mapme.biodiversity&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">st_read</span>(aoi_path, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>aoi</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 1 feature and 0 fields</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -71.73773 ymin: 18.63179 xmax: -71.69 ymax: 18.68691</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt;                             geom</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((-71.73417 18.6435...</span></span></code></pre></div>
</div>
<div id="setting-standard-option" class="section level1">
<h1>Setting standard option</h1>
<p>We use the <code>mapme_options()</code> function and set some
arguments, such as the output directory, that are important to govern
the subsequent processing. For this, we create a temporary directory.
Internally, to save time on downloading when building this vignette, we
copied already existing files to that output location (code not shown
here).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>outdir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;mapme-resources&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">dir.create</span>(outdir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">mapme_options</span>(</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">outdir =</span> outdir,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>outdir</code> argument points towards a directory on the
local file system of your machine. All downloaded resources will be
written to respective directories nested within <code>outdir</code>.</p>
<p>Once you request a specific resource for your portfolio, only those
files will be downloaded that are missing to match its spatio-temporal
extent. This behavior is beneficial, e.g. in case you share the
<code>outdir</code> between different projects to ensure that only
resources matching your current portfolio are returned.</p>
<p>The <code>verbose</code> logical controls whether or not the package
will print informative messages during the calculations. Note, that even
if set to <code>FALSE</code>, the package will inform users about any
potential errors or warnings.</p>
</div>
<div id="getting-the-right-resources" class="section level1">
<h1>Getting the right resources</h1>
<p>You can check which indicators are available via the
<code>available_indicators()</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">available_indicators</span>()</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 37 × 3</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;    name                          description                           resources</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                         &lt;chr&gt;                                 &lt;list&gt;   </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;  1 biodiversity_intactness_index Averaged biodiversity intactness ind… &lt;tibble&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;  2 biome                         Areal statistics of biomes from TEOW  &lt;tibble&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  3 burned_area                   Monthly burned area detected by MODI… &lt;tibble&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  4 deforestation_drivers         Areal statistics of deforestation dr… &lt;tibble&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  5 drought_indicator             Relative wetness statistics based on… &lt;tibble&gt; </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  6 ecoregion                     Areal statstics of ecoregions based … &lt;tibble&gt; </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  7 elevation                     Statistics of elevation based on NAS… &lt;tibble&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;  8 exposed_population            Number of people exposed to conflict… &lt;tibble&gt; </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;  9 fatalities                    Number of fatalities by group of con… &lt;tibble&gt; </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 10 gsw_change                    Statistics of the surface water chan… &lt;tibble&gt; </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">available_indicators</span>(<span class="st">&quot;treecover_area&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;   name           description                  resources       </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;                        &lt;list&gt;          </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; 1 treecover_area Area of forest cover by year &lt;tibble [2 × 5]&gt;</span></span></code></pre></div>
<p>Say, we are interested in the <code>treecover_area</code> indicator.
We can learn more about this indicator and its required resources by
using either of the commands below or, if you are viewing the online
version, head over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/treecover_area.html">treecover_area</a>
documentation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>?treecover_area</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">help</span>(treecover_area)</span></code></pre></div>
<p>By inspecting the help page we learned that this indicator requires
the <code>gfw_treecover</code> and <code>gfw_lossyear</code> resources
and it requires to specify three extra arguments: the years for which to
calculate treecover, the minimum size of patches to be considered as
forest and the minimum canopy coverage of a single pixel to be
considered as forested.</p>
<p>With that information at hand, we can start to retrieve the required
resource. We can learn about all available resources using the
<code>available_resources()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">available_resources</span>()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 33 × 5</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;    name                            description              licence source type </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                           &lt;chr&gt;                    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;  1 biodiversity_intactness_index   Biodiversity Intactness… CC-BY-… https… rast…</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;  2 chelsa                          Climatologies at High r… Unknow… https… rast…</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;  3 chirps                          Climate Hazards Group I… CC - u… https… rast…</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;  4 esalandcover                    Copernicus Land Monitor… CC-BY … https… rast…</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;  5 fritz_et_al                     Drivers of deforestatio… CC-BY … https… rast…</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  6 gfw_emissions                   Global Forest Watch - C… CC-BY … https… rast…</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;  7 gfw_lossyear                    Global Forest Watch - Y… CC-BY … https… rast…</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;  8 gfw_treecover                   Global Forest Watch - P… CC-BY … https… rast…</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;  9 global_surface_water_change     Global Surface Water - … https:… https… rast…</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 10 global_surface_water_occurrence Global Surface Water - … https:… https… rast…</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; # ℹ 23 more rows</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">available_resources</span>(<span class="st">&quot;gfw_treecover&quot;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt;   name          description                                 licence source type </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                                       &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 1 gfw_treecover Global Forest Watch - Percentage of canopy… CC-BY … https… rast…</span></span></code></pre></div>
<p>For the purpose of this vignette, we are going to download both, the
<code>gfw_treecover</code> and <code>gfw_lossyear</code> resources. We
can get more detailed information about a given resource, by using
either of the commands below to open up the help page. If you are
viewing the online version of this documentation, you can simply head
over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/gfw_treecover.html">gfw_treecover</a>
resource documentation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>?gfw_treecover</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">help</span>(gfw_treecover)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>?gfw_lossyear</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">help</span>(gfw_lossyear)</span></code></pre></div>
<p>We can now make the required resources available for our portfolio.
We will use a common interface that is used for all resources, called
<code>get_resources()</code>. We have to specify our portfolio object
and supply one or more resource functions with their respective
arguments. This will then download the matching resources to the output
directory specified earlier.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">get_resources</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">x =</span> aoi,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">get_gfw_treecover</span>(<span class="at">version =</span> <span class="st">&quot;GFC-2023-v1.11&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">get_gfw_lossyear</span>(<span class="at">version =</span> <span class="st">&quot;GFC-2023-v1.11&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="calculate-specific-indicators" class="section level1">
<h1>Calculate specific indicators</h1>
<p>The next step consists of calculating specific indicators. Note that
each indicator requires one or more resources that were made available
via the <code>get_resources()</code> function explained above. You will
have to re-run this function in every new R session, but note that data
that is already available will not be re-downloaded.</p>
<p>Here, we are going to calculate the <code>treecover_area</code>
indicator which is based on the resources from GFW. Since the resources
have been made available in the previous step, we can continue
requesting the calculation of our desired indicator. Note the command
below would issue an error in case a required resource has not been made
available via <code>get_resources()</code> beforehand.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">calc_indicators</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  aoi,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">calc_treecover_area</span>(<span class="at">years =</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2023</span>, <span class="at">min_size =</span> <span class="dv">1</span>, <span class="at">min_cover =</span> <span class="dv">30</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Now let’s take a look at the results. In addition to the metadata we
are already familiar with, we see that there is an additional column
called <code>treecover_area</code> which contains a
<code>tibble</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>aoi</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 1 feature and 2 fields</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -71.73773 ymin: 18.63179 xmax: -71.69 ymax: 18.68691</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt;   assetid treecover_area                                                    geom</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;list&gt;                                                   &lt;POLYGON [°]&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 1       1 &lt;tibble [24 × 4]&gt; ((-71.73735 18.64734, -71.71386 18.63179, -71.69 18…</span></span></code></pre></div>
<p>The indicator is represented as a nested-list column in our
<code>sf</code>-object that is named alike the requested indicator. For
our single asset, this column contains a tibble with 6 rows and four
columns. Let’s have a closer look at this object</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>aoi<span class="sc">$</span>treecover_area</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 × 4</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;    datetime            variable  unit  value</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;    &lt;dttm&gt;              &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;  1 2000-01-01 00:00:00 treecover ha    1975.</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;  2 2001-01-01 00:00:00 treecover ha    1975.</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt;  3 2002-01-01 00:00:00 treecover ha    1973.</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;  4 2003-01-01 00:00:00 treecover ha    1940.</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt;  5 2004-01-01 00:00:00 treecover ha    1930.</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt;  6 2005-01-01 00:00:00 treecover ha    1926.</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;  7 2006-01-01 00:00:00 treecover ha    1919.</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt;  8 2007-01-01 00:00:00 treecover ha    1908.</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt;  9 2008-01-01 00:00:00 treecover ha    1905.</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; 10 2009-01-01 00:00:00 treecover ha    1903.</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more rows</span></span></code></pre></div>
<p>The tibble follows a standard output format, which is the same for
all indicators. Each indicator is represented as a tibble with the four
columns <code>datetime</code>, <code>variable</code>, <code>unit</code>,
and <code>value</code>. In case of the <code>treecover_area</code>
indicator, the variable is called <code>treecover</code> and is
expressed in <code>ha</code>.</p>
<p>Let’s quickly visualize the results:</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>If you wish to change the layout of an portfolio, you can use
<code>portfolio_long()</code> and <code>portfolio_wide()</code> (see the
respective <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/output-wide.html">online
tutorial</a>). Especially for large portfolios, it is usually a good
idea to keep the geometry information in a separated variable to keep
the size of the data object relatively small.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>geoms <span class="ot">&lt;-</span> <span class="fu">st_geometry</span>(aoi)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">portfolio_long</span>(aoi, <span class="at">drop_geoms =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 × 6</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;    assetid indicator      datetime            variable  unit  value</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;chr&gt;          &lt;dttm&gt;              &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  1       1 treecover_area 2000-01-01 00:00:00 treecover ha    1975.</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;  2       1 treecover_area 2001-01-01 00:00:00 treecover ha    1975.</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt;  3       1 treecover_area 2002-01-01 00:00:00 treecover ha    1973.</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;  4       1 treecover_area 2003-01-01 00:00:00 treecover ha    1940.</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;  5       1 treecover_area 2004-01-01 00:00:00 treecover ha    1930.</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;  6       1 treecover_area 2005-01-01 00:00:00 treecover ha    1926.</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;  7       1 treecover_area 2006-01-01 00:00:00 treecover ha    1919.</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  8       1 treecover_area 2007-01-01 00:00:00 treecover ha    1908.</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;  9       1 treecover_area 2008-01-01 00:00:00 treecover ha    1905.</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 10       1 treecover_area 2009-01-01 00:00:00 treecover ha    1903.</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more rows</span></span></code></pre></div>
<div id="a-note-on-parallel-computing" class="section level2">
<h2>A note on parallel computing</h2>
<p><code>{mapme.biodiversity}</code> follows the parallel computing
paradigm of the <a href="https://cran.r-project.org/package=future"><code>{future}</code></a>
package. That means that you as a user are in the control if and how you
would like to set up parallel processing. Since
<code>{mapme.biodiversity} v0.9</code>, we apply pre-chunking to all
assets in the portfolio. That means that assets are split up into
components of roughly the size of <code>chunk_size</code>. These
components can than be iterated over in parallel to speed up processing.
Indicator values will be aggregated automatically.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plan</span>(cluster, <span class="at">workers =</span> <span class="dv">6</span>)</span></code></pre></div>
<p>As another example, with the code below one would apply parallel
processing of 2 assets, with each having 4 workers available to process
chunks, thus requiring a total of 8 available cores on the host machine.
Be sure to not request more workers than available on your machine.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">library</span>(progressr)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">plan</span>(cluster, <span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">with_progress</span>({</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  aoi <span class="ot">&lt;-</span> <span class="fu">calc_indicators</span>(</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    aoi,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="fu">calc_treecover_area_and_emissions</span>(</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>      <span class="at">min_size =</span> <span class="dv">1</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>      <span class="at">min_cover =</span> <span class="dv">30</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    )</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  )</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>})</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">plan</span>(sequential) <span class="co"># close child processes</span></span></code></pre></div>
</div>
</div>
<div id="exporting-an-portfolio-object" class="section level1">
<h1>Exporting an portfolio object</h1>
<p>You can use the <code>write_portfolio()</code> function to save a
processed portfolio object to disk as a <code>GeoPackage</code>. This
allows sharing your data with contributors who might not be using R, but
any other geospatial software. Simply point towards a non-existing file
on your local disk to write the portfolio. You can use
<code>read_portfolio()</code> to read back a GeoPackage written in such
a way into R:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>dsn <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">write_portfolio</span>(<span class="at">x =</span> aoi, <span class="at">dsn =</span> dsn, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>from_disk <span class="ot">&lt;-</span> <span class="fu">read_portfolio</span>(dsn, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>from_disk</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 1 feature and 2 fields</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -71.73773 ymin: 18.63179 xmax: -71.69 ymax: 18.68691</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;   assetid treecover_area                                                    geom</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;list&gt;                                                   &lt;POLYGON [°]&gt;</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; 1       1 &lt;tibble [24 × 4]&gt; ((-71.73735 18.64734, -71.71386 18.63179, -71.69 18…</span></span></code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
