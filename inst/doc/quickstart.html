<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Quickstart</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quickstart</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In the following we will demonstrate an idealized workflow based on a subset of the WorldPop data set that is delivered together with this package. You can follow along the code snippets below to reproduce the results. Please note that to reduce the time it takes to process this vignette, we will not download any resources from the internet. In a real use case, thus processing time might substantially increase because resources have to be downloaded and real portfolios might be larger than the one created in this example.</p>
<p>This vignette assumes that you have already followed the steps in <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/installation.html">Installation</a> and have familiarized yourself with the terminology used in the package. If you are unfamiliar with the terminology used here, please head over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/terminology.html">Terminology</a> article to learn about the most important concepts.</p>
<p>The idealized workflow for using <code>{mapme.biodiversity}</code> consists of the following steps:</p>
<ul>
<li>prepare your sf-object containing only geometries of type <code>&#39;POLYGON&#39;</code> or <code>&#39;MULTIPOLYGON&#39;</code></li>
<li>decide which indicator(s) you wish to calculate and make the required resource(s) available</li>
<li>conduct your indicator calculation, which adds a nested list column to your portfolio object</li>
<li>continue your analysis in R or decide to export your results to a spatial data format to use it with other geospatial software</li>
</ul>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>First, we will load the <code>{mapme.biodiversity}</code> and the <code>{sf}</code> package for handling spatial vector data. For tabular data handling, we will also load the <code>{dplyr}</code> and <code>{tidyr}</code> packages. Then, we will read an internal GeoPackage which includes the geometry of a protected area in the Dominican Republic from the WDPA database.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(mapme.biodiversity)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>aoi_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;sierra_de_neiba_478140.gpkg&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;mapme.biodiversity&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>aoi &lt;-<span class="st"> </span><span class="kw">st_read</span>(aoi_path, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>aoi</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co">#&gt; Simple feature collection with 1 feature and 4 fields</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a><span class="co">#&gt;   WDPAID            NAME     DESIG_ENG ISO3                           geom</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="co">#&gt; 1 478140 Sierra de Neiba National Park  DOM MULTIPOLYGON (((-71.76134 1...</span></span></code></pre></div>
<p>The sf-object contains a single object of geometry type <code>&#39;MULTIPOLYGON&#39;</code>. Each of these polygons will be processed individually before the results are combined and returned. The <code>sf</code> object also contains some metadata (e.g. its WDPAID and its name), that will be retained throughout the complete workflow.</p>
</div>
<div id="setting-standard-option" class="section level1">
<h1>Setting standard option</h1>
<p>We use the <code>mapme_options()</code> function and set some arguments, such as the output directory, that are important to govern the subsequent processing. For this, we create a temporary directory. Internally, to save time on downloading when building this vignette, we copied already existing files to that output location (code not shown here).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>outdir &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;mapme-resources&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">dir.create</span>(outdir, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="kw">mapme_options</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>  <span class="dt">outdir =</span> outdir,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>  <span class="dt">verbose =</span> <span class="ot">TRUE</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>)</span></code></pre></div>
<p>The <code>outdir</code> argument points towards a directory on the local file system of your machine. All downloaded resources will be written to respective directories nested within <code>outdir</code>.</p>
<p>Once you request a specific resource for your portfolio, only those files will be downloaded that are missing to match its spatio-temporal extent. This behavior is beneficial, e.g. in case you share the <code>outdir</code> between different projects to ensure that only resources matching your current portfolio are returned.</p>
<p>The <code>verbose</code> logical controls whether or not the package will print informative messages during the calculations. Note, that even if set to <code>FALSE</code>, the package will inform users about any potential errors or warnings.</p>
</div>
<div id="getting-the-right-resources" class="section level1">
<h1>Getting the right resources</h1>
<p>You can check which indicators are available via the <code>available_indicators()</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">available_indicators</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 25 × 3</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">#&gt;    name                  description                                   resources</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;                                         &lt;list&gt;   </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co">#&gt;  1 active_fire_counts    Number of detected fires by NASA FIRMS        &lt;tibble&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">#&gt;  2 biome                 Areal statistics of biomes from TEOW          &lt;tibble&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co">#&gt;  3 deforestation_drivers Areal statistics of deforestation drivers     &lt;tibble&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co">#&gt;  4 drought_indicator     Relative wetness statistics based on NASA GR… &lt;tibble&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="co">#&gt;  5 ecoregion             Areal statstics of ecoregions based on TEOW   &lt;tibble&gt; </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="co">#&gt;  6 elevation             Statistics of elevation based on NASA SRTM    &lt;tibble&gt; </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="co">#&gt;  7 fatalities            Number of fatalities by group of conflict ba… &lt;tibble&gt; </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="co">#&gt;  8 gsw_change            Statistics of the surface water change layer… &lt;tibble&gt; </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="co">#&gt;  9 gsw_occurrence        Areal statistic of surface water based on oc… &lt;tibble&gt; </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="co">#&gt; 10 gsw_recurrence        Areal statistic of surface water based on re… &lt;tibble&gt; </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="co">#&gt; # ℹ 15 more rows</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="kw">available_indicators</span>(<span class="st">&quot;population_count&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co">#&gt;   name             description                    resources       </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="co">#&gt;   &lt;chr&gt;            &lt;chr&gt;                          &lt;list&gt;          </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co">#&gt; 1 population_count Statistic of population counts &lt;tibble [1 × 5]&gt;</span></span></code></pre></div>
<p>Say, we are interested in the <code>population_count</code> indicator. We can learn more about this indicator and its required resources by using either of the commands below or, if you are viewing the online version, head over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/population_count.html">population_count</a> documentation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>?population_count</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">help</span>(population_count)</span></code></pre></div>
<p>By inspecting the help page we learned that this indicator requires the <code>worldpop</code> resource and it requires to specify two extra arguments: the population statistic to calculate and the eninge to be used for the calculation (learn more about engines <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/terminology.html">here</a>).</p>
<p>With that information at hand, we can start to retrieve the required resource. We can learn about all available resources using the <code>available_resources()</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">available_resources</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 23 × 5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co">#&gt;    name                             description             licence source type </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co">#&gt;    &lt;chr&gt;                            &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co">#&gt;  1 chirps                           Climate Hazards Group … CC - u… https… rast…</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt;  2 esalandcover                     Copernicus Land Monito… CC-BY … https… rast…</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">#&gt;  3 fritz_et_al                      Drivers of deforestati… CC-BY … https… rast…</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">#&gt;  4 gfw_emissions                    Global Forest Watch - … CC-BY … https… rast…</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">#&gt;  5 gfw_lossyear                     Global Forest Watch - … CC-BY … https… rast…</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="co">#&gt;  6 gfw_treecover                    Global Forest Watch - … CC-BY … https… rast…</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="co">#&gt;  7 global_surface_water_change      Global Surface Water -… https:… https… rast…</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a><span class="co">#&gt;  8 global_surface_water_occurrence  Global Surface Water -… https:… https… rast…</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a><span class="co">#&gt;  9 global_surface_water_recurrence  Global Surface Water -… https:… https… rast…</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="co">#&gt; 10 global_surface_water_seasonality Global Surface Water -… https:… https… rast…</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="co">#&gt; # ℹ 13 more rows</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a><span class="kw">available_resources</span>(<span class="st">&quot;worldpop&quot;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="co">#&gt;   name     description                                      licence source type </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;                                            &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a><span class="co">#&gt; 1 worldpop WorldPop - Unconstrained Global Mosaics 2000 - … CC-BY … https… rast…</span></span></code></pre></div>
<p>For the purpose of this vignette, we are going to download the <code>worldpop</code> resource. We can get more detailed information about a given resource, by using either of the commands below to open up the help page. If you are viewing the online version of this documentation, you can simply head over to the <a href="https://mapme-initiative.github.io/mapme.biodiversity/reference/worldpop.html">worldpop</a> resource documentation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>?worldpop</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">help</span>(worldpop)</span></code></pre></div>
<p>We can now make the <code>worldpop</code> resource available for our portfolio. We will use a common interface that is used for all resources, called <code>get_resources()</code>. We have to specify our portfolio object and supply one or more resource functions with their respective arguments. This will then download the matching resources to the output directory specified earlier.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>aoi &lt;-<span class="st"> </span><span class="kw">get_resources</span>(<span class="dt">x =</span> aoi, <span class="kw">get_worldpop</span>(<span class="dt">years =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2015</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="co">#&gt; Skipping existing files in output directory.</span></span></code></pre></div>
<p>In case you want to download more than one resource, you can use the same interface and the resources will be made available sequentially. Required arguments for a resource are simply added as usual:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>aoi &lt;-<span class="st"> </span><span class="kw">get_resources</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>  <span class="dt">x =</span> aoi,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>  <span class="kw">get_worldpop</span>(<span class="dt">years =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2015</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>  <span class="kw">get_gfw_treecover</span>(<span class="dt">version =</span> <span class="st">&quot;GFC-2021-v1.9&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>)</span></code></pre></div>
</div>
<div id="calculate-specific-indicators" class="section level1">
<h1>Calculate specific indicators</h1>
<p>The next step consists of calculating specific indicators. Note that each indicator requires one or more resources that were made available via the <code>get_resources()</code> function explained above. You will have to re-run this function in every new R session, but note that data that is already available will not be re-downloaded.</p>
<p>Here, we are going to calculate the <code>population_count</code> indicator which is based on the <code>worldpop</code> resource. Since the resource has been made available in the previous step, we can continue requesting the calculation of our desired indicator. Note the command below would issue an error in case a required resource has not been made available via <code>get_resources()</code> beforehand.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>aoi &lt;-<span class="st"> </span><span class="kw">calc_indicators</span>(aoi, <span class="kw">calc_population_count</span>(<span class="dt">engine =</span> <span class="st">&quot;zonal&quot;</span>, <span class="dt">stats =</span> <span class="st">&quot;sum&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="co">#&gt; Found a column named &#39;assetid&#39;. Overwritting its values with a unique identifier.</span></span></code></pre></div>
<p>Now let’s take a look at the results. In addition to the metadata we are already familiar with, we see that there is an additional column called <code>population_count</code> which contains a <code>tibble</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>aoi</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="co">#&gt; Simple feature collection with 1 feature and 6 fields</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co">#&gt; Bounding box:  xmin: -71.80731 ymin: 18.57734 xmax: -71.33268 ymax: 18.69799</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 1 × 7</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a><span class="co">#&gt;   WDPAID NAME            DESIG_ENG     ISO3  assetid population_count</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;   &lt;int&gt; &lt;list&gt;          </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a><span class="co">#&gt; 1 478140 Sierra de Neiba National Park DOM         1 &lt;tibble [6 × 4]&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a><span class="co">#&gt; # ℹ 1 more variable: geom &lt;MULTIPOLYGON [°]&gt;</span></span></code></pre></div>
<p>The indicator is represented as a nested-list column in our <code>sf</code>-object that is named alike the requested indicator. For our single asset, this column contains a tibble with 6 rows and four columns. Let’s have a closer look at this object</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>aoi<span class="op">$</span>population_count</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="co">#&gt;   datetime   variable       unit  value</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a><span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a><span class="co">#&gt; 1 2010-01-01 population_sum count 4063.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a><span class="co">#&gt; 2 2011-01-01 population_sum count 4015.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="co">#&gt; 3 2012-01-01 population_sum count 4063.</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a><span class="co">#&gt; 4 2013-01-01 population_sum count 3962.</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a><span class="co">#&gt; 5 2014-01-01 population_sum count 3991.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a><span class="co">#&gt; 6 2015-01-01 population_sum count 4213.</span></span></code></pre></div>
<p>The tibble follows a standard output format, which is the same for all indicators. Each indicator is represented as a tibble with the four columns <code>datetime</code>, <code>variable</code>, <code>unit</code>, and <code>value</code>. In case of the population indicator, the variable is the sum of the population, its unit is a count and the value column gives the actual number.</p>
<p>Let’s quickly visualize the results:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If you wish to change the layout of an portfolio, you can use <code>portfolio_long()</code> and <code>portfolio_wide()</code> (see the respective <a href="https://mapme-initiative.github.io/mapme.biodiversity/articles/output-wide.html">online tutorial</a>). Especially for large portfolios, it is usually a good idea to keep the geometry information in a separated variable to keep the size of the data object relatively small.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>geoms &lt;-<span class="st"> </span><span class="kw">st_geometry</span>(aoi)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">portfolio_long</span>(aoi, <span class="dt">drop_geoms =</span> <span class="ot">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="co">#&gt;   WDPAID NAME  DESIG_ENG ISO3  assetid indicator datetime   variable unit  value</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;     &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="co">#&gt; 1 478140 Sier… National… DOM         1 populati… 2010-01-01 populat… count 4063.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="co">#&gt; 2 478140 Sier… National… DOM         1 populati… 2011-01-01 populat… count 4015.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="co">#&gt; 3 478140 Sier… National… DOM         1 populati… 2012-01-01 populat… count 4063.</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a><span class="co">#&gt; 4 478140 Sier… National… DOM         1 populati… 2013-01-01 populat… count 3962.</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a><span class="co">#&gt; 5 478140 Sier… National… DOM         1 populati… 2014-01-01 populat… count 3991.</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a><span class="co">#&gt; 6 478140 Sier… National… DOM         1 populati… 2015-01-01 populat… count 4213.</span></span></code></pre></div>
</div>
<div id="enabling-parallel-computing" class="section level1">
<h1>Enabling parallel computing</h1>
<p><code>{mapme.biodiversity}</code> follows the parallel computing paradigm of the <a href="https://cran.r-project.org/package=future"><code>{future}</code></a> package. That means that you as a user are in the control if and how you would like to set up parallel processing. Since <code>{mapme.biodiversity} v0.7</code> supports parallel processing on a nested-level. The outer level applies parallel processing to the assets in a portfolio, the inner level to potential chunks for polygons that are larger than the specified chunks size or the single components of assets of type <code>MULTIPOLYGON</code>.</p>
<p>The maximum chunk size is specified in hectares via <code>mapme_options()</code> and defaults to 100,000 ha. Polygons larger than this threshold will be split into chunks of roughly the same size.</p>
<p>Fine-control of parallel processing is given by using future topologies (find more information <a href="https://cran.r-project.org/package=future/vignettes/future-3-topologies.html">here</a>). To process all assets sequentially, but allow to spawn up to 4 workers to process chunks in parallel you might specify:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">library</span>(future)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="kw">plan</span>(<span class="kw">list</span>(sequential, <span class="kw">tweak</span>(cluster, <span class="dt">workers =</span> <span class="dv">6</span>)))</span></code></pre></div>
<p>As another example, with the code below one would apply parallel processing of 2 assets, with each having 4 workers available to process chunks, thus requiring a total of 8 available cores on the host machine. Be sure to not request more workers than available on your machine.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">library</span>(progressr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a><span class="kw">plan</span>(<span class="kw">list</span>(<span class="kw">tweak</span>(cluster, <span class="dt">workers =</span> <span class="dv">2</span>), <span class="kw">tweak</span>(cluster, <span class="dt">workers =</span> <span class="dv">4</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="kw">with_progress</span>({</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>  aoi &lt;-<span class="st"> </span><span class="kw">calc_indicators</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>    aoi,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a>    <span class="kw">calc_treecover_area_and_emissions</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a>      <span class="dt">min_size =</span> <span class="dv">1</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>      <span class="dt">min_cover =</span> <span class="dv">30</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a>    )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a>  )</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a>})</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a><span class="kw">plan</span>(sequential) <span class="co"># close child processes</span></span></code></pre></div>
</div>
<div id="exporting-an-portfolio-object" class="section level1">
<h1>Exporting an portfolio object</h1>
<p>You can use the <code>write_portfolio()</code> function to save a processed portfolio object to disk as a <code>GeoPackage</code> or any other spatial format supported by GDAL. This allows sharing your data with contributors who might not be using R, but any other geospatial software. Simply point towards a non-existing file on your local disk to write the portfolio. You can chose between serializing in the long or wide data layout.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>dsn &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="kw">write_portfolio</span>(<span class="dt">x =</span> aoi, <span class="dt">dsn =</span> dsn, <span class="dt">format =</span> <span class="st">&quot;long&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>from_disk &lt;-<span class="st"> </span><span class="kw">st_read</span>(dsn, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>from_disk</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="co">#&gt; Simple feature collection with 6 features and 10 fields</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a><span class="co">#&gt; Bounding box:  xmin: -71.80731 ymin: 18.57734 xmax: -71.33268 ymax: 18.69799</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a><span class="co">#&gt;   WDPAID            NAME     DESIG_ENG ISO3 assetid        indicator   datetime</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a><span class="co">#&gt; 1 478140 Sierra de Neiba National Park  DOM       1 population_count 2010-01-01</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a><span class="co">#&gt; 2 478140 Sierra de Neiba National Park  DOM       1 population_count 2011-01-01</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a><span class="co">#&gt; 3 478140 Sierra de Neiba National Park  DOM       1 population_count 2012-01-01</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a><span class="co">#&gt; 4 478140 Sierra de Neiba National Park  DOM       1 population_count 2013-01-01</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a><span class="co">#&gt; 5 478140 Sierra de Neiba National Park  DOM       1 population_count 2014-01-01</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a><span class="co">#&gt; 6 478140 Sierra de Neiba National Park  DOM       1 population_count 2015-01-01</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a><span class="co">#&gt;         variable  unit    value                           geom</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a><span class="co">#&gt; 1 population_sum count 4063.447 MULTIPOLYGON (((-71.76202 1...</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a><span class="co">#&gt; 2 population_sum count 4015.088 MULTIPOLYGON (((-71.76202 1...</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a><span class="co">#&gt; 3 population_sum count 4063.247 MULTIPOLYGON (((-71.76202 1...</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a><span class="co">#&gt; 4 population_sum count 3961.917 MULTIPOLYGON (((-71.76202 1...</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a><span class="co">#&gt; 5 population_sum count 3991.399 MULTIPOLYGON (((-71.76202 1...</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a><span class="co">#&gt; 6 population_sum count 4212.674 MULTIPOLYGON (((-71.76202 1...</span></span></code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
